<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Inquiry Form</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="./stylesheets/inquiry.css" />
  </head>
  <body>
    <div id="main">
      <%- include('./partials/header') %>

      <div id="right">
        <%- include('./partials/right-header') %>
        <div id="cover">
          <div class="dropdown mb-3">
            <button
              class="btn btn-secondary dropdown-toggle"
              type="button"
              data-bs-toggle="dropdown"
              aria-expanded="false"
            >
              Add Inquiry
            </button>
            <ul class="dropdown-menu">
              <li>
                <a class="dropdown-item" href="/allenquiry">All Inquiry</a>
              </li>
              <li>
                <a class="dropdown-item" href="/rejected">Rejected Inquiry</a>
              </li>
            </ul>
          </div>

          <div class="inq">
            <form action="/inquiry" method="post" class="row g-3">
              <!-- Inquiry Type -->
              <div class="col-md-12">
                <label class="form-label">Inquiry Type</label>
                <div class="d-flex gap-4">
                  <div class="form-check">
                    <input
                      class="form-check-input"
                      type="radio"
                      name="inquiryType"
                      id="studentRadio"
                      value="student"
                      checked
                    />
                    <label class="form-check-label" for="studentRadio"
                      >Diploma</label
                    >
                  </div>
                  <div class="form-check">
                    <input
                      class="form-check-input"
                      type="radio"
                      name="inquiryType"
                      id="admissionRadio"
                      value="admission"
                    />
                    <label class="form-check-label" for="admissionRadio"
                      >Admission</label
                    >
                  </div>
                </div>
              </div>

              <!-- Student Name -->
              <div class="col-md-6">
                <label for="firstName" class="form-label">Student Name</label>
                <input
                  required
                  type="text"
                  placeholder="Enter First Name"
                  name="firstName"
                  class="form-control"
                  id="firstName"
                />
              </div>
              <div class="col-md-6">
                <label for="lastName" class="form-label">Student Surname</label>
                <input
                  required
                  type="text"
                  name="lastName"
                  placeholder="Enter Last Name"
                  class="form-control"
                  id="lastName"
                />
              </div>

              <!-- Email -->
              <div class="col-12">
                <label for="email" class="form-label">Student Email</label>
                <input
                  required
                  type="email"
                  name="email"
                  class="form-control"
                  id="email"
                  placeholder="Enter Email Address"
                />
              </div>

              <!-- Father/Husband Name -->
              <div class="col-12">
                <label for="fatherName" class="form-label"
                  >Name of Father / Husband</label
                >
                <input
                  required
                  type="text"
                  name="fatherName"
                  class="form-control"
                  id="fatherName"
                  placeholder="Enter Name Of Father / Husband"
                />
              </div>

              <!-- Contact -->
              <div class="col-12">
                <label for="contactNumber" class="form-label"
                  >Contact Number / WhatsApp Number</label
                >
                <input
                  required
                  type="number"
                  name="contactNumber"
                  class="form-control"
                  id="contactNumber"
                  placeholder="Enter Contact Number"
                />
              </div>

              <!-- Course Selection -->
              <div class="col-md-12">
                <label for="courseSelect" class="form-label"
                  >Select Course</label
                >
                <select
                  name="courseId"
                  id="courseSelect"
                  class="form-select"
                  required
                >
                  <option selected disabled>Choose a course...</option>
                </select>
                <input type="hidden" name="courseName" id="courseNameInput" />
              </div>

              <!-- Qualification -->
              <div class="col-md-6">
                <label for="qualification" class="form-label"
                  >Qualification</label
                >
                <input
                  required
                  name="qualification"
                  type="text"
                  class="form-control"
                  placeholder="Enter Qualification"
                  id="qualification"
                />
              </div>

              <!-- Address -->
              <div class="col-md-6">
                <label for="address" class="form-label"
                  >Permanent Address</label
                >
                <input
                  name="address"
                  required
                  type="text"
                  placeholder="Address"
                  class="form-control"
                  id="address"
                />
              </div>

              <!-- Submit Button -->
              <div class="col-12" style="margin-top: 1vmax">
                <button type="submit" class="btn btn-primary">Submit</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Script to update hidden courseName field & filter courses -->
    <script>
      const inquiryRadios = document.getElementsByName("inquiryType");
      const courseSelect = document.getElementById("courseSelect");
      const courseNameInput = document.getElementById("courseNameInput");

      const diplomaCourses = [
        <% course.forEach(c => { %>
          { id: "<%= c._id %>", name: "<%= c.courseName %>" },
        <% }) %>
      ];

      const admissionCourses = [
        <% admcourse.forEach(c => { %>
          { id: "<%= c._id %>", name: "<%= c.courseName %>" },
        <% }) %>
      ];

      function updateCourseOptions(type) {
        let courses = type === "admission" ? admissionCourses : diplomaCourses;
        courseSelect.innerHTML =
          '<option selected disabled>Choose a course...</option>';

        courses.forEach(c => {
          const option = document.createElement("option");
          option.value = c.id;
          option.setAttribute("data-name", c.name);
          option.innerText = c.name;
          courseSelect.appendChild(option);
        });

        courseNameInput.value = "";
      }

      // Listen for type change
      inquiryRadios.forEach(radio => {
        radio.addEventListener("change", () => {
          updateCourseOptions(radio.value);
        });
      });

      // Initial load
      document.addEventListener("DOMContentLoaded", () => {
        const selectedType = document.querySelector('input[name="inquiryType"]:checked').value;
        updateCourseOptions(selectedType);
      });

      // Update courseNameInput on select
      courseSelect.addEventListener("change", function () {
        const selectedOption = courseSelect.options[courseSelect.selectedIndex];
        courseNameInput.value = selectedOption.getAttribute("data-name");
      });
    </script>
  </body>
</html>
